@{
    ViewBag.Title = "Index";
    Layout = "~/Areas/PGM/Views/Shared/_Layout.cshtml";
}
<script src="@Url.Content("~/Scripts/jquery.jqGrid.addons-4.1.2.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/jquery.unobtrusive-ajax.min.js")" type="text/javascript"></script>

<script type="text/javascript">

    $(function () {
        $(".addItem").click(function () {
            $(".validation-summary-errors ").empty();
        });
    });
    // ******** functions for open popup *************
    $(document).ready(function () {

        $("#divEmpList").dialog({ autoOpen: false, modal: true, height: 320, width: 850, title: 'Process Monthly Salary Distribution', beforeclose: function (event, ui) { Closing(); } });
        showErrMsg();

    });

    function showErrMsg() {
        if ('@Model.IsError' == "1") {
            var msg = '@Model.ErrMsg'.replace(/#/gi, "<br/>* ");
            $("#message").html("<b>" + msg + "</b>").css("color", "red");

        }
    }

</script>

@using (Ajax.BeginForm("Index", "SalaryDistribution", new AjaxOptions { HttpMethod = "POST" }, new { id = "frm" }))
{
   
    <div class="GroupBox" id="message">
    </div>
    <div class="GroupBox">
        <div id="jqSearch">
        </div>
        <div class="clear">
        </div>
    </div>
    
    
    <div class="button-crude button-left">
        @if ((new PGM.Web.Utility.AppConstant()).IsAddAssigned)
        {
            <div class="button-crude" style="float: right; text-align: right; width: 530px; margin-right: 0px;">
                <input id="btnAddPayee" type="button" value="Add New" onclick="GoToProcess()" />
            </div>
        }
    </div>
    <div class="clear" style="height: 10px">
    </div>
    <table id="jqGrid" cellpadding="0" cellspacing="0">
    </table>
    <div id="jqGridPager" style="text-align: center;">
    </div>  
    <div id="divList">
        @Html.Partial("_GridList")
    </div>
    
    <div id="divEmpList">
        <iframe id="styleAdvance" src="" width="99%" height="98%" style="border: 0px solid white;
            padding-right: 0px;">
            <p>
                Your browser does not support iframes.</p>
        </iframe>
    </div>
    
} 

<script type="text/javascript">

    function GoToProcess() {

        $("#divEmpList").empty();

        var url = '@Url.Action("CreateOrEdit", "SalaryDistribution")';

        $.ajax({
            url: url,
            type: "POST",
            dataType: 'text',
            timeOut: 15000,
            error: function () {

                alert('System is unable to load data please try again.');
            },
            success: function (result) {

                $('#divEmpList').html(result);
            }
        });

        $("#divEmpList").dialog('open');

        return false;
    }

    function Closing() {

    }


   
</script>
